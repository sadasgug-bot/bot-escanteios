import logging import asyncio from datetime import datetime from telegram import Update from telegram.ext import Application, CommandHandler, ContextTypes # ConfiguraÃ§Ã£o logging.basicConfig( format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO ) logger = logging.getLogger(__name__) TOKEN = "8443274539:AAEZ_jfLKLAHjTquzS9Z650Xn4_-ZwTlrnI" # Armazenamento usuarios = [] async def start(update: Update, context: ContextTypes.DEFAULT_TYPE): user_id = update.effective_user.id if user_id not in usuarios: usuarios.append(user_id) await update.message.reply_text( "ğŸ¤– *BOT DE ESCANTEIOS - ESTRATÃ‰GIA ATUALIZADA!* ğŸš€\n\n" "ğŸ¯ **NOVAS CONDIÃ‡Ã•ES:**\n" "â€¢ ğŸ“Š AnÃ¡lise por xG (Expected Goals)\n" "â€¢ âš¡ Alertas baseados em pressÃ£o real\n" "â€¢ ğŸ² Independente de quantidade de escanteios\n\n" "ğŸ”” **ALERTA 1Âº TEMPO (0-30min):**\n" "- +5 escanteios + xG > 0.50\n" "- Time favorito perdendo/empatando\n\n" "ğŸ”” **ALERTA FINAL (70+min):**\n" "- xG > 1.50 + time favorito pressionando\n" "- Aposta: +0.5 escanteios\n\n" "Digite /estrategia para detalhes", parse_mode='Markdown' ) async def estrategia(update: Update, context: ContextTypes.DEFAULT_TYPE): await update.message.reply_text( "ğŸ“‹ **ESTRATÃ‰GIA DETALHADA** âš½\n\n" "ğŸ¯ **OBJETIVO:** Identificar times pressionando baseado em xG\n\n" "ğŸ”” ALERTA 1Âº TEMPO (0-30min):\n" "âœ… +5 escanteios atÃ© 30min\n" "âœ… xG > 0.50 (Expected Goals)\n" "âœ… Time favorito perdendo/empatando\n" "ğŸ¯ Aposta: +0.5 escanteios restantes\n\n" "ğŸ”” ALERTA FINAL (70+min):\n" "âœ… xG > 1.50 (alta criaÃ§Ã£o de chances)\n" "âœ… Time favorito perdendo/empatando\n" "âœ… PressÃ£o para virar/empatar\n" "ğŸ¯ Aposta: +0.5 escanteios\n\n" "âš¡ **VANTAGEM:** AnÃ¡lise por criaÃ§Ã£o real de chances", parse_mode='Markdown' ) # SIMULADOR DE DADOS COM XG def simular_partidas_com_xg(): """Simula partidas com dados de xG""" from datetime import datetime agora = datetime.now() minuto_atual = agora.minute partidas = [] # Simular alertas baseados no horÃ¡rio if minuto_atual % 10 == 0: # A cada 10 minutos partidas.append({ 'id': f"1t_{agora.strftime('%H%M')}", 'tipo': '1t', 'liga': 'Premier League', 'casa': 'Manchester City', 'visitante': 'Arsenal', 'minuto': 28, 'placar_casa': 0, 'placar_visitante': 1, 'escanteios': 6, 'xg_casa': 0.8, 'xg_visitante': 0.4, 'odd_escanteios': 1.45, 'situacao': 'Favorito perdendo com alto xG' }) if minuto_atual % 15 == 0: # A cada 15 minutos partidas.append({ 'id': f"2t_{agora.strftime('%H%M')}", 'tipo': '2t', 'liga': 'La Liga', 'casa': 'Barcelona', 'visitante': 'Real Madrid', 'minuto': 75, 'placar_casa': 1, 'placar_visitante': 1, 'escanteios': 9, 'xg_casa': 2.1, 'xg_visitante': 1.2, 'odd_escanteios': 1.28, 'situacao': 'Favorito empatando com xG muito alto' }) return partidas # VERIFICAR CONDIÃ‡Ã•ES DA NOVA ESTRATÃ‰GIA def analisar_oportunidade(partida): """Analisa se a partida atende Ã s novas condiÃ§Ãµes""" # ALERTA 1Âº TEMPO (0-30min) if partida['tipo'] == '1t' and partida['minuto'] <= 30: condicoes = [] # +5 escanteios atÃ© 30min if partida['escanteios'] >= 5: condicoes.append("âœ… +5 escanteios atÃ© 30min") # xG > 0.50 para favorito perdendo/empatando time_favorito_pressionando = ( (partida['placar_casa'] <= partida['placar_visitante']) and partida['xg_casa'] > 0.50 ) if time_favorito_pressionando: condicoes.append(f"âœ… xG: {partida['xg_casa']} > 0.50") return len(condicoes) == 1, condicoes # ALERTA FINAL (70+min) elif partida['tipo'] == '2t' and partida['minuto'] >= 70: condicoes = [] # xG > 1.50 para favorito perdendo/empatando time_favorito_pressionando = ( (partida['placar_casa'] <= partida['placar_visitante']) and partida['xg_casa'] > 1.50 ) if time_favorito_pressionando: condicoes.append(f"âœ… xG: {partida['xg_casa']} > 1.50") condicoes.append("âœ… Favorito perdendo/empatando") return len(condicoes) == 1, condicoes return False, [] # ALERTAS AUTOMÃTICOS async def alertas_estrategia_xg(context: ContextTypes.DEFAULT_TYPE): """Alertas baseados na nova estratÃ©gia com xG""" try: if not usuarios: return partidas = simular_partidas_com_xg() for partida in partidas: oportunidade, condicoes = analisar_oportunidade(partida) if oportunidade: if partida['tipo'] == '1t': alerta = f""" ğŸš¨ **ALERTA 1Âº TEMPO - ANÃLISE XG** âš½ ğŸ† {partida['liga']} âš½ {partida['casa']} {partida['placar_casa']}Ã—{partida['placar_visitante']} {partida['visitante']} â° Minuto: {partida['minuto']}' ğŸ“Š Escanteios: {partida['escanteios']} ğŸ¯ xG: {partida['xg_casa']} (Expected Goals) ğŸ’° Odd: {partida['odd_escanteios']} âœ… CONDIÃ‡Ã•ES ATENDIDAS: {chr(10).join(condicoes)} âš¡ OPORTUNIDADE: +0.5 escanteios """ else: alerta = f""" ğŸš¨ **ALERTA FINAL - PRESSÃƒO XG** âš½ ğŸ† {partida['liga']} âš½ {partida['casa']} {partida['placar_casa']}Ã—{partida['placar_visitante']} {partida['visitante']} â° Minuto: {partida['minuto']}' ğŸ“Š xG Total: {partida['xg_casa']} (Alta criaÃ§Ã£o) ğŸ’° Odd: {partida['odd_escanteios']} âœ… CONDIÃ‡Ã•ES ATENDIDAS: {chr(10).join(condicoes)} âš¡ OPORTUNIDADE: +0.5 escanteios (aposta simples) """ for user_id in usuarios: try: await context.bot.send_message( chat_id=user_id, text=alerta, parse_mode='Markdown' ) logger.info(f"ğŸ“¤ Alerta xG enviado para {user_id}") except Exception as e: logger.error(f"âŒ Erro: {e}") logger.info(f"âœ… VerificaÃ§Ã£o xG concluÃ­da - {len(partidas)} partidas") except Exception as e: logger.error(f"âŒ Erro na estratÃ©gia xG: {e}") def main(): try: application = Application.builder().token(TOKEN).build() # Comandos application.add_handler(CommandHandler("start", start)) application.add_handler(CommandHandler("estrategia", estrategia)) # Alertas a cada 7 minutos job_queue = application.job_queue job_queue.run_repeating(alertas_estrategia_xg, interval=420, first=10) logger.info("ğŸš€ BOT COM ESTRATÃ‰GIA XG INICIADO!") print("=" * 60) print("ğŸ¯ NOVA ESTRATÃ‰GIA IMPLEMENTADA!") print("ğŸ“Š AnÃ¡lise por xG (Expected Goals)") print("ğŸ”” Alertas baseados em criaÃ§Ã£o real de chances") print("=" * 60) application.run_polling() except Exception as e: logger.error(f"Erro: {e}") if __name__ == '__main__': main()
